<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
	<title>VEnv: Lua Virtual Environment</title>
    <link rel="stylesheet" href="http://www.keplerproject.org/doc.css" type="text/css"/>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
</head>
<body>

<div id="container">
	
<div id="product">
	<div id="product_logo"><a href="http://www.keplerproject.org">
		<img alt="VEnv logo" src="venv.png"/>
	</a></div>
	<div id="product_name"><big><b>VEnv</b></big></div>
	<div id="product_description">Lua Virtual Environment</div>
</div> <!-- id="product" -->

<div id="main">
	
<div id="navigation">
<h1>VEnv</h1>
	<ul>
		<li><strong>Home</strong>
			<ul>
				<li><a href="index.html#overview">Overview</a></li>
				<li><a href="index.html#status">Status</a></li>
				<li><a href="index.html#download">Download</a></li>
				<li><a href="index.html#history">History</a></li>
				<li><a href="index.html#reference">Reference</a></li>
				<li><a href="index.html#examples">Examples</a></li>
				<li><a href="index.html#credits">Credits</a></li>
				<li><a href="index.html#contact">Contact us</a></li>
			</ul>
		</li>
		<li><a href="license.html">License</a></li>
	</ul>
</div> <!-- id="navigation" -->

<div id="content">


<h2><a name="overview"></a>Overview</h2>

<p>Lua Virtual Environment is a simple library which provides a way
to execute a Lua function in a separate environment, protecting the
original one.</p>

<p>VEnv is free software and uses the same
<a href="license.html">license</a> as Lua 5.0.
</p>


<h2><a name="status"></a>Status</h2>

<p>Current version is 1.0. It was developed for Lua 5.0 and
Lua 5.1.</p>


<h2><a name="download"></a>Download</h2>

<p>
VEnv can be downloaded from its
<a href="http://luaforge.net/project/showfiles.php?group_id=61">LuaForge</a>
page.
</p>


<h2><a name="history"></a>History</h2>

<ul>
<li>[2/dec/2004] Version 1.0 released</li>
<li>[19/Jul/2004] Version 1.0 alpha released</li>
</ul>

<p>
VEnv 1.0 follows the
<a href="http://www.keplerproject.org/compat">package proposal</a>
for Lua 5.1, therefore this package should be "installed".
In other words,
if you are using Lua 5.0, the file <tt>compat-5.1.lua</tt> must be
installed in the <tt>LUA_PATH</tt>. If you are using Lua 5.1,
nothing should be done.
</p>


<h2><a name="reference"></a>Reference</h2>

<p>VEnv provides a single function to do its job:</p>

<ul>
<li><b><code>venv (func) =&gt; function</code></b><br>
 Creates a new function which is the virtual environment to execute
the given function. The given function has its environment changed
to a specially created one which will inherit any global variable
from the original environment. Function <code>venv</code> returns
the new virtual environment created.</li>
</ul>


<h2><a name="examples"></a>Examples</h2>

<p>Suppose the file <tt>script.lua</tt> is as follows:</p>

<pre class="example">
x = "inside"
assert((x == "inside"), "error setting/accessing variable x inside VEnv", x)
assert((os.execute == nil), "os.execute should not be allowed")
var = 1
</pre>

<p>And here is the main chunk which will execute the above script
inside a Virtual Environment.</p>

<pre class="example">
require"venv"
t1 = { t2 = { t3 = "ok" } }
x = "outside"

function sb ()
    assert ((t1.t2.t3 == "ok"), "error accessing multi-indexed variable")
    os.execute = nil
    loadfile ("script.lua")()
end

local prot = venv (sb)
prot ()
assert ((x == "outside"), "variable x modified by VEnv!")
assert ((var == nil), "VEnv modified external environment!")
assert ((os.execute ~= nil), "VEnv modified external environment!")
</pre>


<h2><a name="credits"></a>Credits</h2>

<p>VEnv was designed by Roberto Ierusalimschy, Ana L&uacute;cia de
Moura, Andr&eacute; Carregal and Tom&aacute;s Guisasola as part of the
<a href="http://www.keplerproject.org">Kepler Project</a> which
holds its copyright. It was implemented by Ana L&uacute;cia de
Moura.</p>


<h2><a name="contact"></a>Contact us</h2>

<p>For more information please <a href=
"mailto:info-NO-SPAM-THANKS@keplerproject.org">contact us</a>.
Comments are welcome!</p>

</div> <!-- id="content" -->

</div> <!-- id="main" -->

<div id="about">
	<p><a href="http://validator.w3.org/check?uri=referer"><img src="http://www.w3.org/Icons/valid-xhtml10" alt="Valid XHTML 1.0!" height="31" width="88" /></a></p>
	<p><small>
	$Id: index.html,v 1.10 2005-05-18 21:11:30 uid20006 Exp $
	</small></p>
</div> <!-- id="about" -->

</div> <!-- id="container" -->

</body>
</html> 
